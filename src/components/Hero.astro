---
const slides = [
	{
		image: 'https://happy-m-work.com/wp-content/uploads/2025/01/software-development-6523979_1280.jpg',
		title: '自由なワークスタイルをつくろう',
		description: 'リモートでも現場でも、自分らしく働くためのヒントと実践例をピックアップ。',
		cta: { label: 'READ MORE', href: '/blog#telework' },
	},
	{
		image: 'https://happy-m-work.com/wp-content/uploads/2025/01/source-4280758_1280.jpg',
		title: '最新テクノロジーをキャッチアップ',
		description: '注目のプログラミング言語やフレームワークを素早くキャッチしてスキルアップ。',
		cta: { label: 'READ MORE', href: '/blog#programming' },
	},
	{
		image: 'https://happy-m-work.com/wp-content/uploads/2025/01/macbook-2573421_1280.jpg',
		title: 'キャリアをデザインする',
		description: '市場価値を高める学び方やキャリア戦略を、現役エンジニア目線で解説。',
		cta: { label: 'READ MORE', href: '/blog#skills' },
	},
];
---

<section class="relative isolate overflow-hidden">
	<div class="relative h-[420px] md:h-[520px]">
		{slides.map((slide, index) => (
			<div
				class:list={[
					'absolute inset-0 overflow-hidden opacity-0 transition-opacity duration-700 ease-in-out',
					{ 'opacity-100': index === 0 },
				]}
				data-slide
			>
					<picture>
						<img
							src={slide.image}
							alt={slide.title}
							class="absolute inset-0 h-full w-full object-cover"
							loading="lazy"
							data-slide-image
						/>
					</picture>
					<div class="absolute inset-0 bg-[linear-gradient(45deg,rgba(1,54,104,0.65)_40%,rgba(240,170,198,0.55)_85%)]"></div>
				<div class="relative z-10 mx-auto flex h-full max-w-[1180px] items-center px-6 text-white md:px-8">
					<div class="max-w-2xl space-y-6">
						<p class="font-display text-sm uppercase tracking-[0.6em] text-white/80">Happy Web Engineer</p>
						<h1 class="text-3xl font-bold leading-relaxed tracking-[0.12em] md:text-5xl">{slide.title}</h1>
						<p class="text-sm tracking-[0.12em] text-white/80 md:text-base">{slide.description}</p>
						<a
							class="inline-block rounded-full border border-white bg-white/10 px-8 py-3 text-sm font-semibold tracking-[0.4em] uppercase text-white transition hover:bg-white hover:text-brand-text"
							href={slide.cta.href}
						>
							{slide.cta.label}
						</a>
					</div>
				</div>
			</div>
		))}
	</div>
	<div class="absolute bottom-6 right-1/2 flex translate-x-1/2 justify-center gap-2 md:bottom-8" data-slide-dots>
		{slides.map((_, index) => (
			<button
				type="button"
				class:list={[
					'h-2.5 w-2.5 rounded-full border border-white/60 transition-colors duration-300',
					{ 'bg-white': index === 0 },
				]}
				aria-label={`スライド${index + 1}`}
			></button>
		))}
	</div>
</section>

<script>
const slides = Array.from(document.querySelectorAll('[data-slide]'));
const dots = Array.from(document.querySelectorAll('[data-slide-dots] button'));
const slideImages = slides.map((slide) => slide.querySelector('[data-slide-image]'));
let index = 0;
let timer: ReturnType<typeof setInterval> | undefined;

	const activate = (next: number) => {
		slides.forEach((item, i) => {
			item.classList.toggle('opacity-100', i === next);
		});
		dots.forEach((dot, i) => {
			dot.classList.toggle('bg-white', i === next);
		});
		slideImages.forEach((image, i) => {
			if (!(image instanceof HTMLElement)) return;
			image.classList.remove('animate-hero-zoom');
			if (i === next) {
				void image.offsetWidth;
				image.classList.add('animate-hero-zoom');
			}
		});
		index = next;
	};

	const play = () => {
		timer && clearInterval(timer);
		timer = setInterval(() => {
			const next = (index + 1) % slides.length;
			activate(next);
		}, 5000);
	};

	if (slides.length > 0) {
		activate(0);
		play();
		dots.forEach((dot, dotIndex) => {
			dot.addEventListener('click', () => {
				activate(dotIndex);
				play();
			});
		});
	}
</script>
